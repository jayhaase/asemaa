<div class="absolute" style="left: {{ location.coordinates.x }}%; top: {{ location.coordinates.y }}%">
    <!-- Pulse Animation -->
    <template x-if="$store.locations.shouldPulse('{{ location.id }}')">
        <div class="absolute top-0 left-0 transform -translate-x-1/2 -translate-y-1/2" 
             aria-hidden="true">
            <template x-if="$store.locations.selectedLocation?.id === '{{ location.id }}'">
                <!-- Image pulse for selected state -->
                <div>
                    <div class="absolute w-4 h-4 opacity-75 -mt-1.5 -ml-1.5">
                        <img src="/images/marker.png" alt="" class="w-full h-full">
                    </div>
                    <div class="absolute w-4 h-4 animate-ping-large -mt-1.5 -ml-1.5">
                        <img src="/images/marker.png" alt="" class="w-full h-full opacity-75">
                    </div>
                </div>
            </template>
            <template x-if="$store.locations.selectedLocation?.id !== '{{ location.id }}'">
                <!-- Red dot pulse for default state -->
                <div>
                    <div class="absolute w-2 h-2 bg-red-400 rounded-full opacity-75 -mt-1 -ml-1"></div>
                    <div class="absolute w-2 h-2 bg-red-400 rounded-full animate-ping-large -mt-1 -ml-1"></div>
                </div>
            </template>
        </div>
    </template>
    <!-- Static Marker -->
    <button
        class="absolute top-0 left-0 transform -translate-x-1/2 -translate-y-1/2 cursor-pointer z-10"
        @mouseover="$store.locations.setHoveredLocation('{{ location.id }}')"
        @mouseleave="$store.locations.setHoveredLocation(null)"
        @click="$store.locations.selectLocation('{{ location.id }}')"
        aria-label="View {{ location.name }}"
        aria-expanded="false"
        :aria-expanded="$store.locations.selectedLocation?.id === '{{ location.id }}' ? 'true' : 'false'"
        aria-controls="location-info-{{ location.id }}"
        role="button">
        <!-- Show image for selected state -->
        <template x-if="$store.locations.selectedLocation?.id === '{{ location.id }}'">
            <img src="/images/marker.png" 
                 alt="" 
                 class="w-3 h-3 opacity-60 hover:opacity-100 hover:scale-150 transition-all">
        </template>
        <!-- Show red dot for default state -->
        <template x-if="$store.locations.selectedLocation?.id !== '{{ location.id }}'">
            <div class="bg-red-400 h-2 w-2 rounded-full border border-white 
                      opacity-60 hover:opacity-100 hover:scale-150 transition-all">
            </div>
        </template>
        <span class="sr-only">Location: {{ location.name }}</span>
    </button>
</div> 